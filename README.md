I have since been informed on twitter that there are libs for this:

http://pythonhosted.org/netaddr/tutorial_01.html#summarizing-list-of-addresses-and-subnets
